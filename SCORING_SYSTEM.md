# PaletteDuck 배점 시스템

## 목차
1. [개요](#개요)
2. [정답자 점수 계산](#정답자-점수-계산)
3. [출제자 점수 계산](#출제자-점수-계산)
4. [배율 시스템](#배율-시스템)
5. [시나리오별 예시](#시나리오별-예시)
6. [최대/최소 점수](#최대최소-점수)
7. [게임 밸런스 효과](#게임-밸런스-효과)

---

## 개요

PaletteDuck의 배점 시스템은 다음 원칙을 따릅니다:

- ✅ 정답자는 빨리 맞출수록 높은 점수
- ✅ 출제자는 정답자가 계속 나올수록 점수 증가
- ✅ 힌트를 사용하면 점수 감소하지만 0점은 되지 않음
- ✅ 너무 쉽게 그리면 패널티 (조기 정답 패널티)
- ✅ 인원 수에 따라 출제자 점수 조정

---

## 정답자 점수 계산

### 등수별 기본 점수

| 등수 | 기본 점수 |
|------|----------|
| 1등 | 300점 |
| 2등 | 220점 |
| 3등 | 160점 |
| 4등 | 120점 |
| 5등 | 90점 |
| 6등 이상 | 70점 |

### 힌트 차감

```
최종 점수 = 등수별 기본 점수 - 힌트 차감 (최소 0점)

힌트 차감:
- 초성 힌트 1개당: -25점
- 글자 힌트 1개당: -50점
```

### 예시

**1등, 힌트 없음:** 300점
**1등, 초성 2개:** 300 - 50 = 250점
**1등, 초성 2개 + 글자 1개:** 300 - 100 = 200점
**3등, 글자 2개:** 160 - 100 = 60점

---

## 출제자 점수 계산

### 기본 공식

```
출제자 점수 = Σ(정답자별 기본 점수 × 인원수 배율 × 힌트 배율 × 조기 정답 패널티)
```

정답자가 나올 때마다 누적으로 점수를 받습니다.

### 정답자별 기본 점수

| 정답 순서 | 기본 점수 |
|----------|----------|
| 1번째 | 50점 |
| 2번째 | 45점 |
| 3번째 | 40점 |
| 4번째 | 35점 |
| 5번째 | 30점 |
| 6번째 | 25점 |
| 7번째 이상 | 20점 |

---

## 배율 시스템

### 1. 인원수 배율

| 참가 인원 (출제자 제외) | 배율 |
|----------------------|------|
| 2-4명 | 150% |
| 5-7명 | 120% |
| 8-10명 | 100% |
| 11-15명 | 80% |
| 16-20명 | 65% |

### 2. 힌트 배율

| 힌트 조합 | 배율 |
|----------|------|
| 힌트 없음 | 100% |
| 초성 1개 | 85% |
| 초성 2개 | 70% |
| 초성 3개 | 60% |
| 글자 1개 | 50% |
| 초성 2개 + 글자 1개 | 35% (70% × 50%) |
| 초성 3개 + 글자 2개 | 25.2% (60% × 70% × 60%) |

**최소 배율: 30%** (아무리 많은 힌트를 줘도)

### 3. 조기 정답 패널티 (힌트 0개일 때만)

| 정답률 | 패널티 |
|-------|-------|
| 0-30% | 패널티 없음 |
| 30-50% | -10% |
| 50-70% | -20% |
| 70-100% | -30% |

**중요:** 힌트를 1개라도 사용하면 이 패널티가 **면제**됩니다.

---

## 시나리오별 예시

### 시나리오 1: 4명 게임 (150% 배율)

#### 힌트 없이 3명 정답
```
출제자를 제외한 참가자: 3명

1번째 정답 (1/3 = 33% 정답률):
  50 × 1.5 × 1.0 × 0.9 = 68점 (-10% 패널티)

2번째 정답 (2/3 = 67% 정답률):
  45 × 1.5 × 1.0 × 0.8 = 54점 (-20% 패널티)
  누적: 122점

3번째 정답 (3/3 = 100% 정답률):
  40 × 1.5 × 1.0 × 0.7 = 42점 (-30% 패널티)
  누적: 164점
```

#### 초성 1개 주고 3명 정답
```
힌트 사용으로 패널티 면제

1번째: 50 × 1.5 × 0.85 × 1.0 = 64점
2번째: 45 × 1.5 × 0.85 × 1.0 = 57점 (누적 121점)
3번째: 40 × 1.5 × 0.85 × 1.0 = 51점 (누적 172점)
```

→ **힌트를 주면 더 높은 점수!** (164점 < 172점)

---

### 시나리오 2: 10명 게임 (100% 배율)

#### 초성 2개 주고 5명 정답
```
누적 기본 점수: 50+45+40+35+30 = 200점
배율: 1.0 × 0.7 × 1.0 = 0.7

출제자 총점: 200 × 0.7 = 140점
```

#### 초성 2개 + 글자 1개 주고 4명 정답
```
누적 기본 점수: 50+45+40+35 = 170점
힌트 배율: 0.7 × 0.5 = 0.35
배율: 1.0 × 0.35 × 1.0 = 0.35

출제자 총점: 170 × 0.35 = 60점
```

---

### 시나리오 3: 8명 게임 (120% 배율, 참가자 7명)

#### 초성 1개, 정답자가 계속 나올 때
```
1번째: 50 × 1.2 × 0.85 = 51점
2번째: 45 × 1.2 × 0.85 = 46점 (누적 97점)
3번째: 40 × 1.2 × 0.85 = 41점 (누적 138점)
4번째: 35 × 1.2 × 0.85 = 36점 (누적 174점)
5번째: 30 × 1.2 × 0.85 = 31점 (누적 205점)
6번째: 25 × 1.2 × 0.85 = 26점 (누적 231점)
```

→ **정답자가 계속 나올수록 점수 계속 증가!**

---

### 시나리오 4: 20명 게임 (65% 배율)

#### 힌트 없이 15명 정답
```
누적 기본 점수: 50+45+40+35+30+25+(20×9) = 405점
정답률: 15/19 = 79% → -30% 패널티
배율: 0.65 × 1.0 × 0.7 = 0.455

출제자 총점: 405 × 0.455 = 184점
```

#### 초성 2개 + 글자 1개 주고 10명 정답
```
누적 기본 점수: 50+45+40+35+30+25+(20×4) = 305점
힌트 배율: 0.7 × 0.5 = 0.35
배율: 0.65 × 0.35 × 1.0 = 0.2275

출제자 총점: 305 × 0.2275 = 69점
```

---

## 최대/최소 점수

### 출제자 최대 점수: **268점**

**조건:**
- 20명 게임 (출제자 1 + 참가자 19)
- 초성 힌트 1개 사용
- 19명 모두 정답

**계산:**
```
누적: 50+45+40+35+30+25+(20×13) = 485점
배율: 0.65 × 0.85 × 1.0 = 0.5525
최종: 485 × 0.5525 = 268점
```

### 정답자 최대 점수: **300점**

**조건:**
- 1등
- 힌트 없음

### 점수 비교

| 역할 | 최대 점수 |
|------|----------|
| 정답자 1등 | 300점 |
| 출제자 (최대) | 268점 |
| 정답자 2등 | 220점 |
| 정답자 3등 | 160점 |

→ 출제자는 1등과 2등 사이의 점수를 받을 수 있습니다.

---

## 게임 밸런스 효과

### ✅ 처음부터 끝까지 성의있게 그리기

- 정답자가 계속 나올수록 출제자 점수 계속 증가
- 2-3명 맞춘 후 포기하면 손해

### ✅ 힌트 사용 권장

- 힌트 없이 쉽게 그리면 조기 정답 패널티
- 힌트를 사용하면 패널티 면제
- 적절한 난이도 유지 유도

### ✅ 악용 방지

**문제:** 2-3명 맞춘 후 고의로 엉망으로 그리기
**해결:** 정답자가 계속 나오면 점수가 계속 증가하므로 포기할 이유 없음

**문제:** 힌트로 인해 0점이 되면 그릴 동기 없음
**해결:** 최소 배율 30% 보장으로 절대 0점 안됨

**문제:** 인원이 많으면 출제자 점수 과다
**해결:** 인원수 배율로 조정 (20명: 65%)

### ✅ 적절한 난이도 유도

- 너무 쉽게 그리면: 조기 정답 패널티 (-10% ~ -30%)
- 적절한 난이도: 2-5명 정답 권장
- 힌트 활용: 패널티 면제 + 안정적인 점수

---

## 구현 파일

- `GameConstants.java`: 점수 상수 정의
- `GameScoringService.java`: 점수 계산 로직
- `WebSocketGameController.java`: 점수 기록 및 통합

**마지막 업데이트:** 2025-11-27
